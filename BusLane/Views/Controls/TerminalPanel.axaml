<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:BusLane.ViewModels.Core"
             x:Class="BusLane.Views.Controls.TerminalPanel"
             x:DataType="vm:TerminalHostViewModel">

    <Border Classes="card terminal-panel" Padding="0">
        <Grid RowDefinitions="Auto,*,Auto">
            <Border Grid.Row="0"
                    Background="{DynamicResource SurfaceSubtle}"
                    BorderBrush="{DynamicResource BorderDefault}"
                    BorderThickness="0,0,0,1"
                    Padding="10,8">
                <Grid ColumnDefinitions="*,Auto" VerticalAlignment="Center">
                    <StackPanel Grid.Column="0"
                                Orientation="Horizontal"
                                Spacing="8"
                                VerticalAlignment="Center">
                        <LucideIcon Kind="Terminal"
                                    Size="14"
                                    VerticalAlignment="Center"/>
                        <TextBlock Text="Terminal"
                                   FontWeight="SemiBold"
                                   VerticalAlignment="Center"/>
                        <Ellipse Width="8"
                                 Height="8"
                                 Fill="{Binding StatusIndicatorBrush}"
                                 VerticalAlignment="Center"
                                 ToolTip.Tip="{Binding StatusIndicatorTooltip}"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                Spacing="4"
                                VerticalAlignment="Center">
                        <Button Classes="icon-button"
                                Command="{Binding RestartCommand}"
                                ToolTip.Tip="Restart terminal"
                                Padding="6">
                            <LucideIcon Kind="RotateCcw" Size="13"/>
                        </Button>

                        <Button Classes="icon-button"
                                Command="{Binding ClearOutputCommand}"
                                ToolTip.Tip="Clear output"
                                Padding="6">
                            <LucideIcon Kind="Eraser" Size="13"/>
                        </Button>

                        <Button Classes="icon-button"
                                Command="{Binding UndockCommand}"
                                IsVisible="{Binding TerminalIsDocked}"
                                ToolTip.Tip="Undock terminal"
                                Padding="6">
                            <LucideIcon Kind="ArrowUpFromLine" Size="13"/>
                        </Button>

                        <Button Classes="icon-button"
                                Command="{Binding DockCommand}"
                                IsVisible="{Binding !TerminalIsDocked}"
                                ToolTip.Tip="Dock terminal"
                                Padding="6">
                            <LucideIcon Kind="ArrowDownToLine" Size="13"/>
                        </Button>

                        <Button Classes="icon-button"
                                Command="{Binding CloseCommand}"
                                ToolTip.Tip="Close terminal"
                                Padding="6">
                            <LucideIcon Kind="X" Size="13"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <ScrollViewer Grid.Row="1"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Auto"
                          Padding="10,8"
                          x:Name="TerminalOutputScrollViewer">
                <TextBox Text="{Binding OutputText}"
                         IsReadOnly="True"
                         Background="Transparent"
                         BorderThickness="0"
                         FontFamily="Consolas, Menlo, Monaco"
                         FontSize="12"
                         TextWrapping="NoWrap"
                         AcceptsReturn="True"/>
            </ScrollViewer>

            <Border Grid.Row="2"
                    BorderBrush="{DynamicResource BorderDefault}"
                    BorderThickness="0,1,0,0"
                    Padding="10,8">
                <Grid ColumnDefinitions="Auto,*" ColumnSpacing="8">
                    <TextBlock Grid.Column="0" Text="$" VerticalAlignment="Center" FontWeight="SemiBold"/>
                    <TextBox Grid.Column="1"
                             Text="{Binding InputText, Mode=TwoWay}"
                             Watermark="Type a command and press Enter"
                             FontFamily="Consolas, Menlo, Monaco"
                             FontSize="12">
                        <TextBox.KeyBindings>
                            <KeyBinding Gesture="Enter" Command="{Binding SendInputCommand}"/>
                        </TextBox.KeyBindings>
                    </TextBox>
                </Grid>
            </Border>
        </Grid>
    </Border>
</UserControl>
